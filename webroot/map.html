<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <script type="text/javascript" src="//code.jquery.com/jquery-git.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.1.2/firebase.js"></script>

  <link rel="import" href="bower_components/paper-button/paper-button.html">
  <link rel="import" href="bower_components/paper-dialog/paper-dialog.html">
  <link rel="import" href="bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">

  <style type="text/css">
/* Always set the map height explicitly to define the size of the div
 * element that contains the map. */
#map {
  height: 100%;
}
/* Optional: Makes the sample page fill the window. */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

#location_desc_dialog {
  max-width: 400px;
  max-height: 75%;
}

#location_desc_dialog img{
  float: right;
}

#location_desc_content div {
  margin-bottom: 15px;
}

paper-dialog-scrollable {
  margin-top: 0;
}
  </style>

  <title></title>

<script src="/js/locations.json"></script>
<script src="/js/product_links.json"></script>
<script src="/js/products.json"></script>

<script src="/js/map_classes.js"></script>
<script src="/js/misc.js"></script>

<script type='text/javascript'>//<![CDATA[
window.onload = function() {
};

var map;
var directionsManager;

function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 13,
    center: {lat:35.5086529, lng:135.0703902}
  });
  directionsManager = new DirectionsManager(map);

  Object.entries(LOCATIONS).forEach(function(loc) {
    var infowindow = new google.maps.InfoWindow({
      content: loc[1].name
    });
    var marker = new google.maps.Marker({
      map: map,
      position: {lat: loc[1].lat, lng: loc[1].lng},
      title: loc[1].name,
      icon: loc[1].icon
    });
    marker.addListener('mouseover', function() {
      infowindow.open(map, marker);
    });
    marker.addListener('mouseout', function() {
      infowindow.close();
    });
    marker.addListener('click', function() {
      showDialog(formatLocation(loc[1]));
      directionsManager.showInOut(loc[1]);
    });
  });

  locationInit();
  parseDeepLink();
}
//]]> 

</script>
  
</head>

<body>

<div id="map"></div>

<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyB375rUL5xK8GX8BtfRGoy-yBqarX93n18",
    authDomain: "field-hack-yosano-oryza-1ec51.firebaseapp.com",
    databaseURL: "https://field-hack-yosano-oryza-1ec51.firebaseio.com",
    projectId: "field-hack-yosano-oryza-1ec51",
    storageBucket: "field-hack-yosano-oryza-1ec51.appspot.com",
    messagingSenderId: "561290770409"
  };
  firebase.initializeApp(config);
</script>
<!-- Replace the value of the key parameter with your own API key. -->
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDrUmPwxmxyWknL8LU51wEZvVUKh9x2SbE&callback=initMap"></script>
  
<script>
  // tell the embed parent frame the height of the content
  if (window.parent && window.parent.parent){
    window.parent.parent.postMessage(["resultsFrame", {
      height: document.body.getBoundingClientRect().height,
      slug: "0pcr6fhp"
    }], "*")
  }
</script>

<paper-dialog id="location_desc_dialog" horizontal-align="right" vertical-align="top" no-cancel-on-outside-click>
  <paper-dialog-scrollable id="location_desc_content"></paper-dialog-scrollable>
</paper-dialog>

</body>

</html>
